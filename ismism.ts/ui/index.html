<!DOCTYPE html>
<html>

<head>
	<title>主义主义 活动公示</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<style>
	:root {
		--cl-white: #fff;
		--cl-light-gray: #f1f1f1;
		--cl-gray: #9e9e9e;
		--cl-dark-gray: #616161;
		--cl-black: #000;
		--cl-pale-red: #ffdddd;
		--cl-red: #f44336;
		--cl-amber: #ffc107;
		--cl-purple: #673ab7;
		--small: 12px;
		--normal: 15px;
		--large: 18px;
		--w-max: 1400px;
		--w-rpd: 720px;
		--w-max-content: 960px;
		--w-min-content: 320px;
	}

	.light-gray {
		color: var(--cl-black) !important;
		border-color: var(--cl-black) !important;
		background-color: var(--cl-light-gray) !important;
	}

	.gray {
		color: var(--cl-white) !important;
		border-color: var(--cl-gray) !important;
		background-color: var(--cl-gray) !important;
	}

	.dark-gray {
		color: var(--cl-white) !important;
		border-color: var(--cl-dark-gray) !important;
		background-color: var(--cl-dark-gray) !important;
	}

	.black {
		color: var(--cl-white) !important;
		border-color: var(--cl-black) !important;
		background-color: var(--cl-black) !important;
	}

	.pale-red {
		color: var(--cl-black) !important;
		border-color: var(--cl-pale-red) !important;
		background-color: var(--cl-pale-red) !important;
	}

	.red {
		color: var(--cl-white) !important;
		border-color: var(--cl-red) !important;
		background-color: var(--cl-red) !important;
	}

	.amber {
		color: var(--cl-black) !important;
		border-color: var(--cl-amber) !important;
		background-color: var(--cl-amber) !important;
	}

	.purple {
		color: var(--cl-white) !important;
		border-color: var(--cl-purple) !important;
		background-color: var(--cl-purple) !important;
	}

	html {
		box-sizing: border-box;
		overflow-x: hidden;
	}

	body {
		margin: 0;
		color: var(--cl-black);
		background: var(--cl-light-gray);
		font-family: Verdana, sans-serif;
		font-size: var(--normal);
		line-height: 1.5;
	}

	h1,
	h2,
	h3,
	h4,
	h5,
	h6 {
		font-weight: 400;
		margin: 10px 0
	}

	h1 {
		font-size: 36px
	}

	h2 {
		font-size: 30px
	}

	h3 {
		font-size: 24px
	}

	h4 {
		font-size: 20px
	}

	h5 {
		font-size: 18px
	}

	h6 {
		font-size: 16px
	}

	hr {
		box-sizing: content-box;
		height: 0;
		border: 0;
		border-top: 1px solid #eee;
		overflow: visible;
		margin: 20px 0;
	}

	code {
		font-family: monospace;
		font-size: 1em;
	}

	a {
		color: inherit;
		text-decoration: none;
	}

	header {
		padding-top: 32px;
		padding-bottom: 16px;
		max-width: var(--w-max);
		margin-left: auto;
		margin-right: auto;
		text-align: center;
	}

	header>.tag {
		margin: 16px 32px;
	}

	.tag>a {
		border-width: 1px;
		border-style: solid;
		border-radius: 6px;
		margin-right: 6px;
		margin-bottom: 6px;
		color: var(--cl-black);
		border-color: var(--cl-black);
		background-color: var(--cl-light-gray);
	}

	.tag>a>span {
		display: inline-block;
		padding: 0.1em 8px;
		margin-left: 0.75ch;
		text-align: center;
		border-radius: 50%;
		font-size: var(--small);
		color: var(--cl-white);
		background-color: var(--cl-black);
	}

	.tag>a,
	button {
		display: inline-block;
		padding: 5px 10px;
		vertical-align: middle;
		overflow: hidden;
		text-decoration: none;
		text-align: center;
		cursor: pointer;
		white-space: nowrap;
		user-select: none;
		color: inherit;
		background-color: inherit;
	}

	button {
		border: none;
	}

	button:hover,
	.tag>a:hover {
		color: var(--cl-white) !important;
		border-color: var(--cl-dark-gray) !important;
		background-color: var(--cl-dark-gray) !important;
		opacity: 0.7;
	}

	.banner {
		position: relative;
		padding: 0.01em 16px;
		box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12)
	}

	.banner>button {
		font-size: var(--large);
	}

	.topright {
		position: absolute;
		right: 0;
		top: 0
	}

	.content {
		display: flex;
		flex-flow: row wrap;
		justify-content: center;
		margin-left: auto;
		margin-right: auto;
		max-width: var(--w-max);
		min-width: var(--w-min-content);
	}

	@media (max-width: 960px) {

		.content>.main,
		.content>.side {
			width: 100%;
		}
	}

	@media (min-width:960px) {
		.content>.main {
			flex-basis: var(--w-rpd);
			flex-grow: 3;
		}

		.content>.side {
			flex-basis: var(--w-min-content);
			flex-grow: 1;
		}
	}

	.content>.main>article {
		margin: 16px !important;
		padding-bottom: 10px;
		color: var(--cl-black);
		background: var(--cl-white);
		box-shadow: 0 4px 10px 0 rgba(0, 0, 0, 0.2), 0 4px 20px 0 rgba(0, 0, 0, 0.19);
	}

	.content>.main>article>section {
		padding: 0.01em 16px;
		margin: 10px 0;
	}

	.content .title {
		display: inline-block;
		font-size: 24px;
		font-weight: bold;
		margin: 10px 0;
	}

	.content .title code {
		font-weight: normal;
		color: var(--cl-light-gray);
		background-color: var(--cl-dark-gray);
		padding: 0.1em 8px;
		border-radius: 4px;
		text-align: center
	}

	.content .date {
		color: var(--cl-dark-gray);
		font-size: var(--small);
		font-family: monospace;
		font-style: italic;
		margin: 10px 0;
	}

	.content .photo {
		color: var(--cl-dark-gray);
		text-align: center;
		width: auto;
	}

	.content .photo>div {
		display: flex;
		flex-flow: row wrap;
		align-items: center;
		text-align: center;
		border-top: 1px dotted var(--cl-dark-gray);
		padding: 10px 0;
	}

	@media (max-width: 720px) {
		.content .photo>div>span {
			width: 100%;
		}
	}

	@media (min-width: 720px) {
		.content .photo>div>span {
			flex-basis: 180px;
			flex-grow: 1;
		}

		.content .photo>div>span:nth-child(1) {
			text-align: left;
		}

		.content .photo>div>span:nth-child(2) {
			text-align: center;
		}

		.content .photo>div>span:nth-child(3) {
			text-align: right;
		}
	}

	.content .photo button {
		padding: 0;
		font-size: 1em;
	}

	.content .photo button:nth-child(1):after {
		content: "/";
		margin: 0 5px;
	}

	.content .photo img {
		width: 100%;
		box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);
	}

	.content .stat {
		--fund: 7000;
		--budget: 7000;
		--expense: 3500;
	}

	.content .stat>.bar>.label {
		overflow: auto;
	}

	.content .stat>.bar>.label>*:nth-child(1) {
		float: left;
	}

	.content .stat>.bar>.label>*:nth-child(2) {
		float: right;
	}

	.content .stat>.bar>.label>a {
		text-decoration: underline;
	}

	.content .stat>.bar>.label>a:hover {
		color: var(--cl-amber);
	}

	.content .stat>.bar>div:nth-child(2) {
		margin: 5px 0;
		box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12)
	}

	.content .stat>.bar>div:nth-child(2)>div {
		position: relative;
		width: 100%;
		color: var(--cl-black);
		background-color: var(--cl-light-gray);
		font-family: monospace;
		overflow: hidden;
	}

	.content .stat>.bar>div:nth-child(2)>div>span {
		display: inline-block;
		position: absolute;
		padding: 0.25em 8px;
		left: 0;
		top: 0;
		width: 100%;
		font-size: var(--normal);
		margin: -1px 0;
		min-width: 1ch;
	}

	.content .stat>.bar>div:nth-child(2)>div>span:nth-child(1) {
		position: relative;
		background-color: var(--cl-gray);
	}

	.content .stat>.bar>div:nth-child(2)>div>span.fund {
		width: calc(var(--fund) / var(--budget) * 100%);
	}

	.content .stat>.bar>div:nth-child(2)>div>span.expense {
		width: calc(var(--expense) / var(--budget) * 100%);
	}

	.content .stat>.bar>div:nth-child(2)>div>span:nth-child(2) {
		text-align: center;
		background: none;
	}

	.content .stat>.bar>div:nth-child(2)>div>span:nth-child(3) {
		text-align: right;
		background: none;
		left: -16px;
	}

	.content .stat>.circle {
		display: flex;
		flex-flow: row wrap;
		justify-content: center;
		text-align: center;
		--pct: 65;
	}

	.content .stat>.circle>div {
		flex-basis: 1px;
		flex-grow: 1;
		display: flex;
		flex-flow: column nowrap;
		align-items: center;
		margin: 10px;
		font-size: var(--large);
	}

	.content .stat>.circle>div>div {
		--size: 4em;
		width: var(--size);
		height: var(--size);
		margin-bottom: 10px;
		border-radius: 50%;
		display: grid;
		place-items: center;
		background:
			radial-gradient(closest-side, var(--cl-white) 66%, transparent 0 100%),
			conic-gradient(var(--cl-gray) calc(var(--pct) * 1%), var(--cl-light-gray) 0);
		font-family: monospace;
		font-size: calc(var(--size) / 2);
		box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);
		color: var(--cl-amber);
		text-shadow: 0 2px 2px var(--cl-light-gray);
	}

	.tab {
		display: flex;
		flex-flow: row wrap;
		justify-content: center;
	}

	.tab>button {
		margin: 0 3px;
		font-size: var(--normal);
	}

	.tab>button>span {
		display: inline-block;
		background: var(--cl-black);
		color: var(--cl-white);
		padding: 0.1em 8px;
		text-align: center
	}

	.log {
		background: var(--cl-light-gray);
		border-radius: 16px;
		padding: 16px 8px;
		margin-top: 16px;
		max-height: 480px;
		overflow-y: scroll;
	}

	.log>span {
		display: block;
		width: 100%;
		margin: 8px 0;
		color: var(--cl-gray);
		text-align: center;
	}

	.log>div {
		display: flex;
		flex-flow: row nowrap;
		margin: 16px 0;
	}

	.log>div>div:nth-child(1) {
		display: flex;
		flex-shrink: 0;
		width: 48px;
		height: 48px;
		color: var(--cl-white);
		background: var(--cl-gray);
		border-radius: 50%;
		font-size: 24px;
		justify-content: center;
		align-items: center;
	}

	.log>div>div:nth-child(2) {
		display: flex;
		flex-flow: column nowrap;
		margin-left: 16px;
		margin-right: 8px;
	}

	.log>div>div:nth-child(2)>div:nth-child(1)>span {
		display: inline-block;
		font-size: var(--small);
		background: var(--cl-dark-gray);
		color: var(--cl-white);
		padding: 0.1em 8px;
		text-align: center;
		margin-right: 2px;
		user-select: none;
	}

	.log>div>div:nth-child(2)>div:nth-child(2) {
		font-size: var(--small);
		font-style: italic;
		color: var(--cl-gray);
	}

	.log>div>div:nth-child(2)>div:nth-child(3) {
		min-width: 120px;
		margin-top: 6px;
		padding: 0.5em 16px;
		background-color: var(--cl-light-gray);
		border-radius: 0 8px 8px 8px;
		box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);
	}

	.log>div>div:nth-child(2)>div:nth-child(3)>a {
		text-decoration: underline;
	}

	.log>div>div:nth-child(2)>div:nth-child(3)>a:hover {
		color: var(--cl-amber);
	}

	.log.recent {
		max-height: 100%;
	}

	footer {
		padding: 32px 16px;
		margin-top: 16px;
		color: var(--cl-gray);
		background: var(--cl-dark-gray);
		text-align: center;
	}

	footer>a {
		display: inline-flex;
		align-items: center;
		justify-content: center;
	}

	footer>a>img {
		height: 1.2em;
		margin-right: 0.2em;
	}

	footer>span {
		display: block;
		margin-top: 8px;
		font-size: var(--small);
		font-family: monospace;
	}

	.animate-left {
		position: relative;
		animation: animateleft 0.4s
	}

	@keyframes animateleft {
		from {
			left: -300px;
			opacity: 0
		}

		to {
			left: 0;
			opacity: 1
		}
	}

	.animate-right {
		position: relative;
		animation: animateright 0.4s
	}

	@keyframes animateright {
		from {
			right: -300px;
			opacity: 0
		}

		to {
			right: 0;
			opacity: 1
		}
	}

	.animate-opacity {
		position: relative;
		animation: animateopacity 0.4s;
	}

	@keyframes animateopacity {
		from {
			transform: scale(0.25);
			opacity: 0;
		}

		to {
			transform: scale(1);
			opacity: 1;
		}
	}

</style>

<body>
	<div class="banner dark-gray animate-right">
		<button onclick="this.parentElement.style.display='none'" class="dark-gray topright">&times;</button>
		<h3>提示!</h3>
		<p>网站开发中。当前页面皆为测试内容。</p>
	</div>

	<header class="animate-left">
		<a href="">
			<h1><b>主义主义 <span style="color: var(--cl-red)">活动</span>公示</b></h1>
		</a>
		<hr>
		<div class="tag">
			<a class="dark-gray" href="#">全部公示<span>2</span></a><a href="#进行中">进行中<span>2</span></a><a
				href="#已结束">已结束<span>0</span></a><a href="#设施建设">设施建设<span>1</span></a><a
				href="#设施建设">物资配给<span>1</span></a><a href="#软件开发">软件开发<span>1</span></a><a
				href="#苏州">苏州<span>1</span></a><a href="#成都">成都<span>1</span></a><a
				href="#星星家园">星星家园<span>1</span></a><a href="#主义主义网站">主义主义网站<span>1</span></a>
		</div>
	</header>

	<div class="content animate-right">
		<div class="main">
			<article>
				<section>
					<a href="#1" class="title"><code>#1</code> 星星家园改造</a>
					<div class="tag">
						<a href="#进行中">进行中</a><a href="#已结束">已结束</a><a href="#设施建设">设施建设</a><a href="#设施建设">物资配给</a><a
							href="#软件开发">软件开发</a><a href="#苏州">苏州</a><a href="#成都">成都</a><a href="#星星家园">星星家园</a><a
							href="#主义主义网站">主义主义网站</a>
					</div>
					<div class="date">公示时间：2022-08-12 12:32<br>更新时间：2022-08-12 12:32</div>
				</section>

				<section class="photo">
					<div>
						<span>墙面施工</span>
						<span><button>上一张</button><button>下一张</button></span>
						<span>第1张 / 共6张</span>
					</div>
					<img src="https://img1.imgtp.com/2022/08/30/kk0PLIlC.jpg" />
				</section>

				<section class="stat animate-opacity">
					<div class="bar">
						<div class="label">
							<span>收到支持</span>
							<span>预算(元)</span>
						</div>
						<div>
							<div>
								<span class="fund">123456</span>
								<span>50%</span>
								<span>123456</span>
							</div>
							<div>
								<span class="expense">12345</span>
								<span>25%</span>
							</div>
						</div>
						<div class="label">
							<span>当前支出</span>
							<a target="_blank" rel="noopener"
								href="https://docs.qq.com/sheet/DZU1qaWRsUnJJU1Z1">查看明细</a>
						</div>
					</div>
					<div><br>活动目标：</div>
					<div class="circle">
						<div>
							<div style="--pct: 65">65%</div>
							<span>雨棚扩建雨棚扩建雨棚扩建雨棚扩建雨棚扩建雨棚扩建雨棚扩建雨棚扩建雨棚扩建</span>
						</div>
						<div>
							<div style="--pct: 65">65%</div>
							<span>雨棚扩建雨棚扩建</span>
						</div>
						<div>
							<div style="--pct: 100; color: var(--cl-gray)">完成</div>
							<span>雨棚扩建雨棚扩建</span>
						</div>
						<div>
							<div style="--pct: 0; color: var(--cl-gray)">0%</div>
							<span>雨棚扩建</span>
						</div>
					</div>
				</section>

				<section>
					<div class="tab">
						<button><span>332</span> 条活动日志 ❯</button>
						<button><span>32</span> 名参与者 ❯</button>
						<button><span>3212</span> 位支持者 ❯</button>
					</div>
					<div class="log">
						<span>322 条活动日志</span>
						<div>
							<div>u</div>
							<div>
								<div>username <span>badge1</span><span>badge2</span></div>
								<div>timestamp</div>
								<div>msg</div>
							</div>
						</div>
						<div>
							<div>u</div>
							<div>
								<div>username <span>badge</span><span class="light-gray">badge</span><span
										class="gray">badge</span><span class="dark-gray">badge</span><span
										class="black">badge</span><span class="pale-red">badge</span><span
										class="red">badge</span><span class="amber">badge</span><span
										class="purple">badge</span>
								</div>
								<div>timestamp</div>
								<div>Mauris neque quam, fermentum ut nisl vitae, convallis maximus nisl. Sed
									mattis nunc id lorem
									euismod placerat. Vivamus porttitor magna enim, ac accumsan tortor cursus at.
									Phasellus sed
									ultricies mi non congue ullam corper. Praesent tincidunt sed
									tellus ut rutrum. Sed vitae justo condimentum, porta lectus vitae, ultricies congue
									gravida
									diam non fringilla</div>
							</div>
						</div>
						<div>
							<div>u</div>
							<div>
								<div>username <span>badge1</span><span>badge2</span></div>
								<div>timestamp</div>
								<div>Mauris neque quam, fermentum ut nisl vitae, convallis maximus nisl. Sed
									mattis nunc id lorem
									euismod placerat. Vivamus porttitor magna enim, ac accumsan tortor cursus at.
									Phasellus sed
									ultricies mi non congue ullam corper. Praesent tincidunt sed
									tellus ut rutrum. Sed vitae justo condimentum, porta lectus vitae, ultricies congue
									gravida
									diam non fringilla</div>
							</div>
						</div>
						<span>322 条活动日志</span>
					</div>
				</section>
			</article>
		</div>

		<div class="side">
			<div class="log recent">
				<span>322 条活动日志</span>
				<div>
					<div></div>
					<div>
						<div>username <span>badge1</span><span>badge2</span></div>
						<div>timestamp</div>
						<div>msg</div>
					</div>
				</div>
				<div>
					<div></div>
					<div>
						<div>username <span>badge1</span><span>badge2</span><span>badge2</span></div>
						<div>timestamp</div>
						<div>Mauris neque quam, fermentum ut nisl vitae, convallis maximus nisl. Sed
							mattis nunc id lorem
							euismod placerat. Vivamus porttitor magna enim, ac accumsan tortor cursus at.
							Phasellus sed
							ultricies mi non congue ullam corper. Praesent tincidunt sed
							tellus ut rutrum. Sed vitae justo condimentum, porta lectus vitae, ultricies congue
							gravida
							diam non fringilla</div>
					</div>
				</div>
				<div>
					<div></div>
					<div>
						<div>username <span>badge1</span><span>badge2</span></div>
						<div>timestamp</div>
						<div>Mauris neque quam, fermentum ut nisl vitae, convallis maximus nisl. Sed
							mattis nunc id lorem
							euismod placerat. Vivamus porttitor magna enim, ac accumsan tortor cursus at.
							Phasellus sed
							ultricies mi non congue ullam corper. Praesent tincidunt sed
							tellus ut rutrum. Sed vitae justo condimentum, porta lectus vitae, ultricies congue
							gravida
							diam non fringilla</div>
					</div>
				</div>
				<span>322 条活动日志</span>
			</div>
		</div>
	</div>

	<footer class="animate-left">
		<a href="https://space.bilibili.com/23191782" target="_blank" rel="noopener"><img
				src="https://www.bilibili.com/favicon.ico">未明子</a> ·
		<a href="https://space.bilibili.com/19147010" target="_blank" rel="noopener"><img
				src="https://www.bilibili.com/favicon.ico">张正午</a>
		<span>网站维护：seven.two.eight@outlook.com</span>
	</footer>
</body>

<script>
	let hash = ""

	const tags = [
		"",
		"进行中",
		"已结束",
		"设施建设",
		"物资配给",
		"软件开发",
		"苏州",
		"杭州",
		"成都",
		"星星家园",
		"主义主义网站"
	]

	function etag(
		el, tags, ct = false
	) {
		el.innerHTML = ""
		for (let t of tags) {
			const a = document.createElement("a")
			a.href = `#${t}`
			if (t == hash) a.classList.add("dark-gray")
			a.innerHTML = t.length == 0 ? "全部公示" : t
			if (ct) a.innerHTML += `<span>${articles.filter(p => t.length == 0 || p.tag.includes(t)).length}</span>`
			el.appendChild(a)
		}
	}

	const articles = [
		{
			aid: 2,
			title: "星星家园改造",
			tag: ["进行中", "设施建设", "苏州", "星星家园"],
			date: { pub: "2022-08-04 14:35", update: "2022-08-24 12:34" },
			img: [
				{ title: "墙面施工", src: "https://img1.imgtp.com/2022/08/30/kk0PLIlC.jpg" },
				{ title: "防水涂层", src: "https://img1.imgtp.com/2022/08/30/AxvEND6h.jpg" },
				{ title: "堆放点", src: "https://img1.imgtp.com/2022/08/30/hDH79lFo.jpg" },
				{ title: "平面图", src: "https://img1.imgtp.com/2022/08/30/TjxiIeeg.jpg" },
				{ title: "庭院", src: "https://img1.imgtp.com/2022/08/30/mfqTjt9n.jpg" },
				{ title: "室内", src: "https://img1.imgtp.com/2022/08/30/ymN6Lziv.jpg" },
			],
			nimg: 0,
			stat: {
				fund: 7000, budget: 7000, expense: 4500,
				detail: "https://docs.qq.com/sheet/DZU1qaWRsUnJJU1Z1",
				progress: [
					{ goal: "淋浴间改造", pct: 0 },
					{ goal: "卫生间改造", pct: 25 },
					{ goal: "墙面改造", pct: 75 },
					{ goal: "吊顶改造", pct: 85 },
					{ goal: "雨棚安装", pct: 100 },
				]
			},
			participant: [
				{ uid: "未明子", role: ["发起人", "参与者"], badge: ["星星家园"], date: "2022-08-24 12:34", msg: "作为发起人与负责人参与活动" },
				{ uid: "张正午", role: ["发起人", "参与者"], badge: ["星星家园"], date: "2022-08-24 12:34", msg: "作为发起人与负责人参与活动" },
				{ uid: "username1", role: ["参与者", "支持者"], badge: ["星星家园"], date: "2022-08-24 12:34", msg: "作为施工者参与活动" },
				{ uid: "username2", role: ["参与者"], badge: ["星星家园"], date: "2022-08-24 12:34", msg: "作为施工者参与活动" },
				{ uid: "username3", role: ["参与者"], badge: ["星星家园"], date: "2022-08-24 12:34", msg: "作为施工者参与活动" },
			],
			activity: [
				{ uid: "未明子", date: "2022-07-24 12:34", msg: "发起了活动" },
				{ uid: "张正午", date: "2022-07-24 12:34", msg: "发起了活动" },
				{ uid: "张正午", date: "2022-08-04 14:35", msg: `发布了视频 <a href="https://www.bilibili.com/video/BV1zT411L7JP" target="_blank" rel="noopener">工人子弟晚托班苏州星星家园环境改造/伙食改善公益项目工作记录</a>` },
				{ uid: "未明子", date: "2022-08-04 22:17", msg: `发布了视频 <a href="https://www.bilibili.com/video/BV1xG4y1v7MV" target="_blank" rel="noopener">【现实行动】我们目前的一个行动项目</a>` },
				{ uid: "未明子", date: "2022-08-17 00:37", msg: `发布了视频 <a href="https://www.bilibili.com/video/BV1dg41167Y9" target="_blank" rel="noopener">【项目跟踪】晚托班项目硬装计划介绍</a>` },
				{ uid: "username1", date: "2022-08-22 12:34", msg: "完成了 a b c d<br>目标进度 +100%：雨棚安装" },
				{ uid: "username2", date: "2022-08-22 12:34", msg: "完成了 a b c d<br>目标进度 +85%：吊顶改造" },
				{ uid: "username3", date: "2022-08-22 12:34", msg: "完成了 a b c d<br>目标进度 +75%：墙面改造" },
				{ uid: "username3", date: "2022-08-22 12:34", msg: "完成了 a b c d<br>目标进度 +25%：卫生间改造" },
				{ uid: "未明子", date: "2022-08-23 00:46", msg: `发布了视频 <a href="https://www.bilibili.com/video/BV1eB4y1z7Qc" target="_blank" rel="noopener">【项目追踪】晚托班改造计划硬装部分阶段性介绍</a>` },
			],
			sponsor: [
				{ uid: "username4", role: ["参与者", "支持者"], badge: ["星星家园"], date: "2022-08-24 12:34", msg: "提供支持 +3500" },
				{ uid: "星星家园徽章买家", role: ["支持者"], badge: ["星星家园"], date: "2022-08-24 12:34", msg: "提供支持 +3500<br>网站开放注册后将邀请徽章买家注册用户名并加入支持者列表" },
			]
		}, {
			aid: 1,
			title: "星星家园晚餐供应",
			tag: ["进行中", "物资配给", "苏州", "星星家园"],
			date: { pub: "2022-08-04 14:35", update: "2022-08-24 12:34" },
			stat: {
				fund: 0, budget: 3000, expense: 0,
				detail: "https://docs.qq.com/sheet/DZWVJeVd6V1ZlYklk",
				progress: [
					{ goal: "2022九月晚餐", pct: 0 },
					{ goal: "2022十月晚餐", pct: 0 },
					{ goal: "2022十一月晚餐", pct: 0 },
					{ goal: "2022十二月晚餐", pct: 0 },
				]
			},
			participant: [
				{ uid: "未明子", role: ["发起人"], badge: ["星星家园"], date: "2022-07-04 12:34", msg: "作为发起人参与活动" },
				{ uid: "张正午", role: ["发起人"], badge: ["星星家园"], date: "2022-07-04 12:34", msg: "作为发起人参与活动" },
			],
			activity: [
				{ uid: "张正午", date: "2022-08-04 14:35", msg: `发布了视频 <a href="https://www.bilibili.com/video/BV1zT411L7JP" target="_blank" rel="noopener">工人子弟晚托班苏州星星家园环境改造/伙食改善公益项目工作记录</a>` },
				{ uid: "未明子", date: "2022-08-04 22:17", msg: `发布了视频 <a href="https://www.bilibili.com/video/BV1xG4y1v7MV" target="_blank" rel="noopener">【现实行动】我们目前的一个行动项目</a>` },
			],
			sponsor: []
		}, {
			aid: 0,
			title: "主义主义网站开发",
			tag: ["进行中", "软件开发", "杭州", "成都", "主义主义网站"],
			date: { pub: "2022-08-12 12:32", update: "2022-08-31 15:45" },
			stat: {
				fund: 105, budget: 105, expense: 105,
				detail: "https://docs.qq.com/sheet/DZUl1Q1N5aGNGYk9x",
				progress: [
					{ goal: "主义主义卡片重铸网站", pct: 0 },
					{ goal: "主义主义活动公示网站", pct: 15 },
					{ goal: "魔怔人论坛", pct: 100 },
				]
			},
			participant: [
				{ uid: "川羽", role: ["参与者"], badge: ["主义主义网站"], date: "2022-08-24 12:34", msg: "作为程序员参与活动" },
				{ uid: "未明子", role: ["发起人", "支持者"], badge: ["主义主义网站"], date: "2022-07-04 12:34", msg: "作为发起人参与活动" },
				{ uid: "张正午", role: ["发起人"], badge: ["主义主义网站"], date: "2022-07-04 12:34", msg: "作为发起人参与活动" },
				{ uid: "万大可", role: ["参与者", "支持者"], badge: ["主义主义网站"], date: "2022-07-24 12:34", msg: "作为程序员参与活动" },
			],
			activity: [
				{ uid: "川羽", date: "2022-08-24 12:34", msg: "魔怔人论坛上线<br>目标进度 +100%：魔怔人论坛" },
				{ uid: "未明子", date: "2022-07-04 01:38", msg: `发布了视频 <a href="https://www.bilibili.com/video/BV1if4y1Z7xo" target="_blank" rel="noopener">【实践】我的行动路径——我卖什么货，我开什么店，我成立什么团体，我追求什么理想</a>` },
				{ uid: "未明子", date: "2022-08-01 01:46", msg: `发布了视频 <a href="https://www.bilibili.com/video/BV1wa411M7jK" target="_blank" rel="noopener">【公告】我们眼下的行动路径</a>` },
				{ uid: "万大可", date: "2022-08-13 15:45", msg: `上线了网站 ismist.cn<br>目标进度 +15%：主义主义活动公示网站` },
				{ uid: "未明子", date: "2022-08-14 01:45", msg: `发布了视频 <a href="https://www.bilibili.com/video/BV1EG411t7Wh" target="_blank" rel="noopener">【行动计划】我们打算做一个什么样的网站（1）——初步功能</a>` },
				{ uid: "万大可", date: "2022-08-31 15:45", msg: `更新了网站 ismist.cn` },
			],
			sponsor: [
				{ uid: "未明子", role: ["发起人", "支持者"], badge: ["主义主义网站"], date: "2022-08-08 12:34", msg: "提供支持 +35 购买域名 ismism.cn" },
				{ uid: "万大可", role: ["参与者", "支持者"], badge: ["主义主义网站"], date: "2022-08-11 12:34", msg: "提供支持 +70 购买域名 ismist.cn 与 主义主义.中国" },
			]
		}
	]

	const recent = [
		{ uid: "username2", role: ["参与者"], badge: ["星星家园"], date: "2022-08-22 12:34", msg: "完成了 a b c d<br>目标进度 +85%：吊顶改造" },
		{ uid: "username3", role: ["参与者"], badge: ["星星家园"], date: "2022-08-22 12:34", msg: "完成了 a b c d<br>目标进度 +75%：墙面改造" },
		{ uid: "username3", role: ["参与者"], badge: ["星星家园"], date: "2022-08-22 12:34", msg: "完成了 a b c d<br>目标进度 +25%：卫生间改造" },
		{ uid: "未明子", role: ["发起人", "参与者"], badge: ["星星家园"], date: "2022-08-23 00:46", msg: `发布了视频 <a href="https://www.bilibili.com/video/BV1eB4y1z7Qc" target="_blank" rel="noopener">【项目追踪】晚托班改造计划硬装部分阶段性介绍</a>` },
		{ uid: "万大可", role: ["参与者"], badge: ["主义主义网站"], date: "2022-08-31 15:45", msg: `更新了网站 ismist.cn` },
	]

	function etitle(
		el, { aid, title, tag, date }
	) {
		el.innerHTML = ""
		const a = document.createElement("a")
		a.href = `#${aid}`
		a.classList.add("title")
		a.innerHTML = `<code>#${aid}</code> ${title}`
		el.appendChild(a)
		const t = document.createElement("div")
		t.classList.add("tag")
		etag(t, tag)
		el.appendChild(t)
		const d = document.createElement("div")
		d.classList.add("date")
		d.innerHTML = `公示时间：${date.pub}<br>更新时间：${date.update}`
		el.appendChild(d)
	}

	function eimg(
		el, d
	) {
		el.innerHTML = ""
		if (d.img == undefined || d.img.length == 0) return
		const img = document.createElement("img")
		const span = [
			document.createElement("span"),
			document.createElement("span"),
			document.createElement("span"),
		]
		const nimg = dn => {
			d.nimg = ((d.nimg + dn) % d.img.length + d.img.length) % d.img.length
			span[0].innerHTML = d.img[d.nimg].title
			span[2].innerHTML = `第${d.nimg + 1}张 / 共${d.img.length}张`
			img.src = d.img[d.nimg].src
		}
		nimg(0)
		const prev = document.createElement("button")
		prev.innerHTML = "上一张"
		prev.addEventListener("click", () => nimg(-1))
		span[1].appendChild(prev)
		const next = document.createElement("button")
		next.innerHTML = "下一张"
		next.addEventListener("click", () => nimg(+1))
		span[1].appendChild(next)
		const div = document.createElement("div")
		span.forEach(s => div.appendChild(s))
		el.appendChild(div)
		el.appendChild(img)
	}

	function estat(
		el, stat
	) {
		el.innerHTML = ""
		const bar = document.createElement("div")
		bar.classList.add("bar")
		bar.style.setProperty("--fund", stat.fund)
		bar.style.setProperty("--budget", stat.budget)
		bar.style.setProperty("--expense", stat.expense)
		bar.innerHTML = `<div class="label"><span>收到支持</span><span>预算(元)</span></div>`
			+ `<div><div><span class="fund">${stat.fund}</span><span>${(stat.fund / stat.budget * 100).toFixed(0)}%</span><span>${stat.budget}</span></div>`
			+ `<div><span class="expense">${stat.expense}</span><span>${(stat.expense / stat.budget * 100).toFixed(0)}%</span></div></div>`
			+ `<div class="label"><span>当前支出</span><a target="_blank" rel="noopener"href="${stat.detail}">查看明细</a></div>`
		el.appendChild(bar)
		const div = document.createElement("div")
		div.innerHTML = "<br>活动目标："
		el.appendChild(div)
		const circle = document.createElement("div")
		circle.classList.add("circle")
		circle.innerHTML = stat.progress
			.map(({ goal, pct }) => {
				const c = pct == 0 || pct >= 100 ? "color: var(--cl-gray)" : ""
				const t = pct >= 100 ? "完成" : `${pct}%`
				return `<div><div style="--pct: ${pct};${c}">${t}</div><span>${goal}</span></div>`
			})
			.join("")
		el.appendChild(circle)
	}

	const crole = new Map([
		["发起人", "red"],
		["参与者", "amber"],
		["支持者", "purple"],
	]);

	function elog(
		el, { participant, activity, sponsor }
	) {
		el.innerHTML = ""
		const tab = document.createElement("div")
		tab.classList.add("tab")
		tab.innerHTML = `<button><span>${activity.length}</span> 条活动日志 ❯</button>`
			+ `<button><span>${participant.length}</span> 名参与者 ❯</button>`
			+ `<button><span>${sponsor.length}</span> 位支持者 ❯</button>`
		const logp = document.createElement("div")
		logp.classList.add("log")
		logp.innerHTML = `<span>${participant.length} 名参与者</span>`
		for (const p of participant) {
			const badge = [
				...p.role.map(r => `<span class=${crole.get(r)}>${r}</span>`),
				...p.badge.map(r => `<span class="black"}>${r}</span>`)
			].join("")
			logp.innerHTML += `<div><div>${p.uid[0]}</div><div><div>${p.uid} ${badge}</div><div>${p.date}</div><div>${p.msg}</div></div></div>`
		}
		logp.innerHTML += `<span>${participant.length} 名参与者</span>`
		const loga = document.createElement("div")
		loga.classList.add("log")
		loga.innerHTML = `<span>${activity.length} 条活动日志</span>`
		for (const a of activity) {
			const p = participant.find(p => p.uid == a.uid)
			const badge = p == undefined ? "" : [
				...p.role.map(r => `<span class=${crole.get(r)}>${r}</span>`),
				...p.badge.map(r => `<span class="black"}>${r}</span>`)
			].join("")
			loga.innerHTML += `<div><div>${a.uid[0]}</div><div><div>${a.uid} ${badge}</div><div>${a.date}</div><div>${a.msg}</div></div></div>`
		}
		loga.innerHTML += `<span>${activity.length} 条活动日志</span>`
		const logs = document.createElement("div")
		logs.classList.add("log")
		logs.innerHTML = `<span>${sponsor.length} 位支持者</span>`
		for (const s of sponsor) {
			const badge = [
				...s.role.map(r => `<span class=${crole.get(r)}>${r}</span>`),
				...s.badge.map(r => `<span class="black"}>${r}</span>`)
			].join("")
			logs.innerHTML += `<div><div>${s.uid[0]}</div><div><div>${s.uid} ${badge}</div><div>${s.date}</div><div>${s.msg}</div></div></div>`
		}
		logs.innerHTML += `<span>${sponsor.length} 位支持者</span>`
		const log = [loga, logp, logs]
		const toggle = (b, n) => {
			if (b.classList.contains("dark-gray")) {
				b.classList.remove("dark-gray")
				log[n].style.display = "none"
			} else {
				for (const c of tab.children) c.classList.remove("dark-gray")
				log.forEach(l => l.style.display = "none")
				b.classList.add("dark-gray")
				log[n].style.display = "block"
				log[n].scrollTop = log[n].scrollHeight
			}
		}
		tab.children[0].addEventListener("click", () => toggle(tab.children[0], 0))
		tab.children[1].addEventListener("click", () => toggle(tab.children[1], 1))
		tab.children[2].addEventListener("click", () => toggle(tab.children[2], 2))
		el.appendChild(tab)
		log.forEach(l => { l.style.display = "none"; el.appendChild(l) })
	}

	function earticle(
		el
	) {
		el.innerHTML = ""
		const aid = parseInt(hash)
		console.log(aid)
		const ds = isNaN(aid)
			? (hash.length > 0 ? articles.filter(a => a.tag.includes(hash)) : articles)
			: [articles.find(p => p.aid == aid)]
		for (const d of ds) {
			const a = document.createElement("article")
			let s = document.createElement("section")
			etitle(s, d)
			a.appendChild(s)
			s = document.createElement("section")
			s.classList.add("photo")
			eimg(s, d)
			a.appendChild(s)
			el.appendChild(a)
			s = document.createElement("section")
			s.classList.add("stat")
			estat(s, d.stat)
			a.appendChild(s)
			s = document.createElement("section")
			elog(s, d)
			a.appendChild(s)
			el.appendChild(a)
		}
	}

	function erecent(
		el
	) {
		el.innerHTML = ""
		const log = document.createElement("div")
		log.classList.add("log")
		log.classList.add("recent")
		log.innerHTML = `<span>${recent.length} 条最新动态</span>`
		for (const r of recent) {
			const badge = [
				...r.role.map(r => `<span class=${crole.get(r)}>${r}</span>`),
				...r.badge.map(r => `<span class="black"}>${r}</span>`)
			].join("")
			log.innerHTML += `<div><div>${r.uid[0]}</div><div><div>${r.uid} ${badge}</div><div>${r.date}</div><div>${r.msg}</div></div></div>`

		}
		el.appendChild(log)
	}

	window.addEventListener("hashchange", () => {
		hash = decodeURI(window.location.hash).substr(1)
		etag(
			document.getElementsByTagName("header")[0].getElementsByClassName("tag")[0],
			tags, true
		)
		earticle(document.getElementsByClassName("main")[0])
		erecent(document.getElementsByClassName("side")[0])
	})

	function load(
	) {
		window.dispatchEvent(new Event("hashchange"))
	}

	load()
</script>

</html>
